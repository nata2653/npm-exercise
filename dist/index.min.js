const form=document.querySelector("#addForm");function get(){fetch("https://frontend2019-28cd.restdb.io/rest/movies",{method:"get",headers:{"Content-type":"application/json; charset-utf-8","x-apikey":"5d887478fd86cb75861e25fe","cache-control":"no-cache"}}).then(e=>e.json()).then(e=>{e.forEach(addNewMovie)})}function addNewMovie(e){const t=document.querySelector("template").content.cloneNode(!0);t.querySelector("article.movie").dataset.movieid=e._id,t.querySelector("h1").textContent=e.name,t.querySelector("h2").textContent=e.year,t.querySelector("p").textContent=e.protagonist,t.querySelector(".delete").addEventListener("click",()=>{deleteIt(e._id)}),document.querySelector("#app").prepend(t)}function post(){const e={name:form.elements.name.value,year:form.elements.year.value,protagonist:form.elements.protagonist.value},t=JSON.stringify(e);console.log(t),fetch("https://frontend2019-28cd.restdb.io/rest/movies",{method:"post",headers:{"Content-Type":"application/json; charset=utf-8","x-apikey":"5d887478fd86cb75861e25fe","cache-control":"no-cache"},body:t}).then(e=>e.json()).then(e=>{console.log(e),addNewMovie(e)})}function deleteIt(e){fetch("https://frontend2019-28cd.restdb.io/rest/movies/"+e,{method:"delete",headers:{"Content-type":"application/json; charset-utf-8","x-apikey":"5d887478fd86cb75861e25fe","cache-control":"no-cache"}}).then(e=>e.json()).then(t=>{console.log(t),document.querySelector(`.movie[data-movieid="${e}"]`).remove()})}form.addEventListener("submit",e=>{e.preventDefault(),post()}),get();
